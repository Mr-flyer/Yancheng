<!DOCTYPE html>
<html lang="en">
<!-- 热门路线 -->

<head>
    <base href="../static/">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="lib/weui.min.css">
    <link rel="stylesheet" href="css/jquery-weui.css">
    <link rel="stylesheet" href="./css/family_list.css">
    <script src="https://mat1.gtimg.com/jiangsu/lib/js/zepto.js"></script>
    <title>旅游路线</title>
</head>

<body>
    <div class="container">
        <!--主体-->
        <div class='weui-content' id="listwrap">
            <!--下拉刷新-->
            <div class="weui-pull-to-refresh__layer">
                <div class="weui-pull-to-refresh__arrow"></div>
                <div class="weui-pull-to-refresh__preloader"></div>
                <div class="down">下拉刷新</div>
                <div class="up">释放刷新</div>
                <div class="refresh">正在刷新</div>
            </div>
            <div class="Route_Container">
                <div class="Route_show">
                    <a>
                        <div class="Route_img">
                            <img src="./upload/route_test1.png">
                        </div>
                        <div class="Route_info">
                            <div class="Route_info_title">海盐历史文化风景区</div>
                            <div class="Route_info_text">盐城中国海盐博物馆是全国唯一的一次冒险的好机会，值得沃恩其看一看</div>
                            <div class="Route_info_visit">
                                <div class="Route_info_visitNum_img">
                                    <img src="./images/route_browse.png">
                                </div>
                                <div class="Route_info_visitNum_Num"><span class="Route_info_visitNum_Nums">8206</span>次</div>
                            </div>
                        </div>
                    </a>
                </div>
                <div class="Route_show">
                    <a>
                        <div class="Route_img">
                            <img src="./upload/route_test1.png">
                        </div>
                        <div class="Route_info">
                            <div class="Route_info_title">海盐历史文化风景区</div>
                            <div class="Route_info_text">盐城中国海盐博物馆是全国唯一的一次冒险的好机会，值得沃恩其看一看</div>
                            <div class="Route_info_visit">
                                <div class="Route_info_visitNum_img">
                                    <img src="./images/route_browse.png">
                                </div>
                                <div class="Route_info_visitNum_Num"><span class="Route_info_visitNum_Nums">8206</span>次</div>
                            </div>
                        </div>
                    </a>
                </div>
                <div class="Route_show">
                    <a>
                        <div class="Route_img">
                            <img src="./upload/route_test1.png">
                        </div>
                        <div class="Route_info">
                            <div class="Route_info_title">海盐历史文化风景区</div>
                            <div class="Route_info_text">盐城中国海盐博物馆是全国唯一的一次冒险的好机会，值得沃恩其看一看</div>
                            <div class="Route_info_visit">
                                <div class="Route_info_visitNum_img">
                                    <img src="./images/route_browse.png">
                                </div>
                                <div class="Route_info_visitNum_Num"><span class="Route_info_visitNum_Nums">8206</span>次</div>
                            </div>
                        </div>
                    </a>
                </div>
                <div class="Route_show">
                        <a>
                            <div class="Route_img">
                                <img src="./upload/route_test1.png">
                            </div>
                            <div class="Route_info">
                                <div class="Route_info_title">海盐历史文化风景区</div>
                                <div class="Route_info_text">盐城中国海盐博物馆是全国唯一的一次冒险的好机会，值得沃恩其看一看</div>
                                <div class="Route_info_visit">
                                    <div class="Route_info_visitNum_img">
                                        <img src="./images/route_browse.png">
                                    </div>
                                    <div class="Route_info_visitNum_Num"><span class="Route_info_visitNum_Nums">8206</span>次</div>
                                </div>
                            </div>
                        </a>
                    </div>
                    <div class="Route_show">
                            <a>
                                <div class="Route_img">
                                    <img src="./upload/route_test1.png">
                                </div>
                                <div class="Route_info">
                                    <div class="Route_info_title">海盐历史文化风景区</div>
                                    <div class="Route_info_text">盐城中国海盐博物馆是全国唯一的一次冒险的好机会，值得沃恩其看一看</div>
                                    <div class="Route_info_visit">
                                        <div class="Route_info_visitNum_img">
                                            <img src="./images/route_browse.png">
                                        </div>
                                        <div class="Route_info_visitNum_Num"><span class="Route_info_visitNum_Nums">8206</span>次</div>
                                    </div>
                                </div>
                            </a>
                        </div>
                        <div class="Route_show">
                                <a>
                                    <div class="Route_img">
                                        <img src="./upload/route_test1.png">
                                    </div>
                                    <div class="Route_info">
                                        <div class="Route_info_title">海盐历史文化风景区</div>
                                        <div class="Route_info_text">盐城中国海盐博物馆是全国唯一的一次冒险的好机会，值得沃恩其看一看</div>
                                        <div class="Route_info_visit">
                                            <div class="Route_info_visitNum_img">
                                                <img src="./images/route_browse.png">
                                            </div>
                                            <div class="Route_info_visitNum_Num"><span class="Route_info_visitNum_Nums">8206</span>次</div>
                                        </div>
                                    </div>
                                </a>
                            </div>
                <div class="Route_show">
                    <a>
                        <div class="Route_img">
                            <img src="./upload/route_test1.png">
                        </div>
                        <div class="Route_info">
                            <div class="Route_info_title">海盐历史文化风景区</div>
                            <div class="Route_info_text">盐城中国海盐博物馆是全国唯一的一次冒险的好机会，值得沃恩其看一看</div>
                            <div class="Route_info_visit">
                                <div class="Route_info_visitNum_img">
                                    <img src="./images/route_browse.png">
                                </div>
                                <div class="Route_info_visitNum_Num"><span class="Route_info_visitNum_Nums">8206</span>次</div>
                            </div>
                        </div>
                    </a>
                </div>
                <!-- <div class="more">更多活动，敬请期待</div> -->
            </div>
            <!-- 加载中 -->
            <div class="weui-loadmore" style="padding-bottom:30px;height:20px">
                <span class="weui-loadmore__tips">
                        <!-- <i class="weui-loading"></i> -->
                        上拉加载更多
                    </span>
            </div>
        </div>
    </div>

</body>
<script src="lib/jquery-2.1.4.js"></script>
<script src="js/jquery-weui.js"></script>
<script src="https://unpkg.com/art-template@4.13.2/lib/template-web.js"></script>
<script src="js/config.js"></script>
<!-- 用于展示信息的模板 -->
<script id="Route_show_template" type="text/html">
    {{each data }}
    <div class="Route_show">
        <a>
            <div class="Route_img">
                <img src="{{$value.line_icon}}">
            </div>
            <div class="Route_info">
                <div class="Route_info_title">{{$value.line_name}}</div>
                <div class="Route_info_text">{{$value.description}}</div>
                <div class="Route_info_visit">
                    <div class="Route_info_visitNum_img">
                        <img src="./images/route_browse.png">
                    </div>
                    <div class="Route_info_visitNum_Num"><span class="Route_info_visitNum_Nums">{{$value.line_status}}</span>次</div>
                </div>
            </div>
        </a>
    </div>
    {{/each}}
</script>
<script>
    // var ind = getUrlQueryString('id');

    // function getUrlQueryString(names, urls) {
    //     urls = urls || window.location.href;
    //     urls && urls.indexOf("?") > -1 ? urls = urls
    //         .substring(urls.indexOf("?") + 1) : "";
    //     var reg = new RegExp("(^|&)" + names + "=([^&]*)(&|$)", "i");
    //     var r = urls ? urls.match(reg) : window.location.search.substr(1)
    //         .match(reg);
    //     if (r != null && r[2] != "")
    //         return unescape(r[2]);
    //     return null;
    // };
    $("#listwrap").pullToRefreshDone(); // 重置下拉刷新
    let listData = []
    let flag = true,
        page = 1;
    id = 1 // --------------------------------------------------  活动ID ---------------------------------
    // init()

    function init() {
        $.ajax({
            url: `${baseUrl}/api/v1/lineinfo/readall`,
            data: {
                id: 1
            },
            success(res) {
                console.log(res)
                let {
                    error_code,
                    data: {
                        items: data
                    }
                } = res
                listData = data
                if (error_code === 0) {
                    console.log(template('Route_show_template', {
                        data: listData
                    }))
                    $('.Route_Container').append(template('Route_show_template', {
                        data: listData
                    }))
                }
                $("#listwrap").pullToRefreshDone(); // 重置下拉刷新
            },
            error(err) {
                $('.container').html('<img class="err" src="images/error.png" alt="">')
            }
        })
    }
    //============================ 下拉刷新
    $("#listwrap").pullToRefresh().on("pull-to-refresh", function() {
        init()
    });

    //============================滚动加载
    $("#listwrap").infinite().on("infinite", function() {
        if (flag) {
            // console.log('加载中');
            // $('.weui-loadmore').find('.weui-loading').show();
            $('.weui-loadmore').find('.weui-loadmore__tips').text('加载中');
            flag = false
            page = page + 1
            $.ajax({
                url: `${baseUrl}/api/v1/lineinfo/readall`,
                data: {
                    id: 1
                },
                success(res) {
                    let {
                        error_code,
                        data: {
                            items: data
                        }
                    } = res
                    listData = data
                    if (error_code === 0) {
                        // console.log(data);
                        console.log(res.data);
                        $('.Route_Container').append(template('Route_show_template', {
                            data: listData
                        }))
                    }
                    flag = true
                    $("#listwrap").pullToRefreshDone(); // 重置下拉刷新
                },

                error(err) {
                    $('.container').html('<img class="err" src="images/error.png" alt="">')
                }
            })

        }

    });
</script>

</html>